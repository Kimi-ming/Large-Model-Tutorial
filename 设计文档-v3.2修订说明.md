# 设计文档 v3.2 修订说明

**修订日期**: 2025-11-01  
**修订版本**: v3.1 → v3.2  
**修订目的**: 优化验收标准，降低复现门槛，增强学习指导

---

## 修订原则

根据评审反馈，进行以下三方面的优化：
1. **高优先级**：将苛刻的硬性指标改为参考区间和对照表
2. **中优先级1**：为章节添加学习目标、实践任务和成果验收
3. **中优先级2**：明确区分教程必需标准和维护者可选标准

---

## 一、高优先级修订：优化验收标准

### 问题描述
原有验收标准设定了过于苛刻的硬性指标（如"LoRA精度≥90%"、"8卡效率≥85%"、"处理速度≥1000张/秒"），对教学示例不可达，学习者和贡献者难以复现。

### 修改策略
将"硬阈值"改为"可运行 + 参考区间 + 对照表"，明确高阶性能目标为进阶/附录内容。

### 具体修改

#### 1. LoRA微调标准

**修改前**：
```markdown
**验收标准**：在公开数据集上达到论文精度90%以上
```

**修改后**：
```markdown
**验收标准**：
- 代码能完整运行，无致命错误
- 提供可复现的训练日志和Notebook
- 验证集效果相比冻结基线有实质提升（建议±3%以内为合理范围）
- 提供参考结果对照表（不同数据集/模型的基线区间）
```

#### 2. QLoRA微调标准

**修改前**：
```markdown
**验收标准**：显存占用<原生LoRA的50%
```

**修改后**：
```markdown
**验收标准**：
- 代码能完整运行
- 提供Full-FT/LoRA/QLoRA三档显存对比（实测数据+截图）
- 显存对比报告说明：QLoRA相对FP16建议下降30-60%（仅供参考，不同环境可能有差异）
- 说明精度变化情况（可接受的退化范围）
```

#### 3. 全参数微调标准

**修改前**：
```markdown
**验收标准**：8卡训练效率≥85%线性扩展
```

**修改后**：
```markdown
**验收标准**：
- 提供单卡和多卡可运行配置
- 多卡扩展性能为进阶内容：提供实测对比数据和趋势说明
- 说明常见瓶颈和优化方向（不要求达到理论线性扩展）
```

#### 4. 数据处理标准

**修改前**：
```markdown
**验收标准**：处理速度≥1000张/秒
```

**修改后**：
```markdown
**验收标准**：
- 代码能完整运行
- 提供不同环境的性能参考表（CPU/T4/A100等，仅供参考）
- 说明性能优化技巧和可扩展方向
```

#### 5. 部署性能标准

**修改前**：
```markdown
**验收标准**：推理速度提升≥2倍
```

**修改后**：
```markdown
**验收标准**：
- ONNX转换成功，TensorRT引擎可用
- 提供PyTorch vs TensorRT性能对比数据（建议提升范围1.5-3倍，因模型而异）
- 说明转换步骤和常见问题
```

---

## 二、中优先级1：增加学习指导元素

### 问题描述
章节详细列出主题，但缺少面向学习者的目标、难度、任务等信息，难以形成学习路径闭环。

### 修改策略
为每个主要章节（第2.1-2.4部分）添加：
- 学习目标
- 先修要求
- 难度和工作量标签
- 实践任务
- 学习成果验收
- 参考结果区间（仅供对照）

### 具体修改示例

#### 第2.1部分：视觉大模型调研与选型

**新增内容**：
```markdown
**学习目标**：
- 了解主流视觉大模型的架构和特点
- 掌握模型选型的方法和决策依据
- 能够独立完成模型对比和评测

**先修要求**：
- 必需：深度学习基础、计算机视觉入门
- 推荐：了解Transformer架构

**难度标签**：⭐⭐ 入门  
**工作量标签**：🔨 中等

**实践任务**：
1. 在Colab上运行3个视觉大模型的推理示例
2. 完成一个简单的模型对比表格（参数量、速度、精度）
3. 为自己的应用场景选择合适的模型并说明理由

**学习成果验收**：
- 能说出至少5个主流视觉大模型的名称和特点
- 能独立运行模型推理代码
- 能根据任务需求进行模型选型
```

#### 第2.2部分：模型微调技术

**新增参考结果区间**：
```markdown
**参考结果区间**（供学习者对照）：
| 方法 | 训练显存（7B模型） | 推理显存 | 相对精度 |
|------|-------------------|---------|---------|
| 全参数微调 | 60-80GB | 14-16GB | 基线 |
| LoRA | 20-30GB | 14-16GB | -0.5~1% |
| QLoRA | 10-15GB | 14-16GB | -1~2% |

*注：实际数值因模型、数据、环境而异，此表仅供参考*
```

#### 第2.4部分：多平台部署

**新增性能参考区间**：
```markdown
**性能参考区间**（ResNet50示例）：
| 部署方式 | QPS（单卡） | 延迟 | 显存占用 |
|---------|------------|------|---------|
| PyTorch FP32 | 50-80 | 12-20ms | 2GB |
| PyTorch FP16 | 100-150 | 6-10ms | 1.5GB |
| TensorRT FP16 | 200-300 | 3-5ms | 1GB |

*注：实际数值因硬件、batch size、输入尺寸而异*
```

---

## 三、中优先级2：区分教程要求和维护要求

### 问题描述
第6章和第7章混杂了仓库维护者的工程化要求（CI矩阵、radon、80%覆盖率）与教程内容标准，提高了贡献门槛。

### 修改策略
使用清晰的标签区分：
- 📚 **教程必需**：所有内容贡献者必须满足
- 🔧 **维护者可选**：仓库维护者的工程化要求，初次贡献者可忽略

### 具体修改

#### 1. 第6章添加说明

**新增说明块**：
```markdown
> **说明**：本章节包含教程内容要求和仓库维护要求。
> - 📚 **教程必需**：教程内容必须满足的标准（如代码可运行、文档清晰）
> - 🔧 **维护者可选**：仓库工程化要求（如CI配置、测试覆盖率），初次贡献者可忽略
```

#### 2. 交付内容分类标注

**示例**：
```markdown
1. **项目脚手架**（🔧 维护者）
   - CI/CD基础配置
   
2. **开发环境配置**（📚 教程必需）
   - requirements.txt
   - 环境安装脚本
   
4. **代码框架**（📚 教程必需 + 🔧 维护者可选）
   - 基础工具类 - 教程必需
   - 单元测试框架 - 维护者可选
   - **验收标准**：
     - 📚 教程必需：代码能正常运行，有基本注释
     - 🔧 维护者可选：代码覆盖率≥80%
```

#### 3. 第7章质量标准分类

**文档质量标准表格**：
| 维度 | 指标 | 目标值 | 类型 | 检查方式 |
|------|------|--------|------|----------|
| 内容准确性 | 代码可运行率 | 100% | 📚 必需 | 手动测试 |
| 可读性 | Flesch难度 | 40-60 | 🔧 维护者 | 分析工具 |
| 完整性 | API覆盖率 | 100% | 🔧 维护者 | 自动对比 |

**代码质量标准表格**：
| 维度 | 指标 | 目标值 | 类型 | 检查工具 |
|------|------|--------|------|----------|
| 代码规范 | 基本代码风格 | 清晰易读 | 📚 必需 | 人工审查 |
| | PEP 8符合率 | 100% | 🔧 维护者 | flake8 |
| 测试覆盖 | 示例可运行性 | 100% | 📚 必需 | 手动测试 |
| | 单元测试覆盖率 | >80% | 🔧 维护者 | pytest-cov |

#### 4. 自动化配置标注

**添加说明**：
```markdown
#### 🔧 自动化检查配置（维护者）

以下配置用于仓库的工程化管理，**初次贡献者无需关注**。
```

---

## 修订效果对比

### 验收标准对比

| 方面 | v3.1（修订前） | v3.2（修订后） | 改进 |
|------|---------------|---------------|------|
| LoRA精度 | "≥90%" | "有实质提升（±3%参考范围）+ 对照表" | ✅ 可达性提升 |
| QLoRA显存 | "<50%" | "30-60%参考范围（因环境而异）" | ✅ 灵活性增强 |
| 数据处理 | "≥1000张/秒" | "提供不同环境参考表" | ✅ 复现性改善 |
| 部署性能 | "≥2倍" | "1.5-3倍参考范围" | ✅ 合理区间 |

### 学习指导对比

| 元素 | v3.1 | v3.2 | 状态 |
|------|------|------|------|
| 学习目标 | ❌ 无 | ✅ 3-5条明确目标 | 新增 |
| 先修要求 | ❌ 无 | ✅ 必需/推荐分级 | 新增 |
| 难度标签 | ❌ 无 | ✅ ⭐标识+工作量🔨 | 新增 |
| 实践任务 | ❌ 无 | ✅ 3个具体任务 | 新增 |
| 学习验收 | ❌ 无 | ✅ 可验证的成果 | 新增 |
| 参考区间 | ❌ 无 | ✅ 性能对照表 | 新增 |

### 标准分类对比

| 类别 | v3.1 | v3.2 | 改进 |
|------|------|------|------|
| 标准混杂 | 教程+工程未区分 | 📚必需 / 🔧可选标注 | ✅ 清晰分层 |
| 贡献门槛 | 所有标准一视同仁 | 初次贡献者只看📚 | ✅ 降低门槛 |
| 工程化标准 | 与教程标准混在一起 | 独立标注"维护者" | ✅ 职责明确 |

---

## 未解决的问题（低优先级）

评审中提到的低优先级问题暂未处理，建议后续版本考虑：

1. **学习反馈闭环**：
   - 建议：每章小测/自测题、练习提交通道、满意度调查
   - 状态：待v3.3版本或实际运营时补充

2. **章节练习/作业**：
   - 建议：GitHub Issue + exercise标签、评分rubric
   - 状态：待教程内容成熟后再设计

---

## 总结

v3.2修订显著提升了设计文档对教程场景的适配度：

### ✅ 核心改进
1. **可复现性**：硬性指标→参考区间，学习者不再为"达标"焦虑
2. **学习指导**：增加目标/任务/验收，形成学习闭环
3. **贡献门槛**：明确区分必需/可选，降低初次贡献难度

### 🎯 设计理念
- **以学习者为中心**：指标设计考虑可达性和复现性
- **参考而非承诺**：提供区间和对照表，而非单一阈值
- **分层设计**：区分教程内容标准和仓库工程标准

### 📈 预期效果
- 学习者更容易上手和完成实践
- 贡献者更清楚哪些是必需的
- 维护者保留工程化标准的权威性

---

**修订完成时间**: 2025-11-01  
**修订者**: 小铭kimi  
**评审依据**: 用户提供的High/Medium优先级反馈  
**下一步**: 根据实际教程运营情况，补充低优先级的学习反馈机制

