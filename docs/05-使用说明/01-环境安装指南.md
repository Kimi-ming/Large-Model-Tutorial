# ç¯å¢ƒå®‰è£…æŒ‡å—

æœ¬æ–‡æ¡£å°†å¸®åŠ©æ‚¨å¿«é€Ÿæ­å»ºè§†è§‰å¤§æ¨¡å‹æ•™ç¨‹çš„å¼€å‘å’Œå­¦ä¹ ç¯å¢ƒã€‚

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚

| ç»„ä»¶ | æœ€ä½è¦æ±‚ | æ¨èé…ç½® |
|------|---------|---------|
| **CPU** | 4æ ¸å¿ƒ | 8æ ¸å¿ƒ+ |
| **å†…å­˜** | 8GB | 16GB+ |
| **ç¡¬ç›˜** | 50GBå¯ç”¨ç©ºé—´ | 100GB+ SSD |
| **GPU** | æ— ï¼ˆCPUæ¨¡å¼ï¼‰| NVIDIA GPU 8GB+ æ˜¾å­˜ |

> **ğŸ’¡ è¯´æ˜**ï¼š
> - CPUæ¨¡å¼å¯ä»¥å®Œæˆæ¨ç†å’Œè½»é‡çº§å¾®è°ƒï¼Œä½†é€Ÿåº¦è¾ƒæ…¢
> - GPUæ¨¡å¼æ¨èç”¨äºæ¨¡å‹è®­ç»ƒå’Œå¤§è§„æ¨¡æ¨ç†
> - æ”¯æŒNVIDIA CUDAã€AMD ROCmã€Apple Silicon (MPS)

### è½¯ä»¶è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**ï¼š
  - Ubuntu 20.04/22.04/24.04
  - macOS 12+
  - Windows 10/11 (é€šè¿‡WSL2)
- **Python**ï¼š3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆæ¨è 3.10/3.11ï¼‰
- **Git**ï¼šç”¨äºå…‹éš†ä»£ç ä»“åº“
- **ï¼ˆå¯é€‰ï¼‰Conda/Miniconda**ï¼šç¯å¢ƒç®¡ç†å·¥å…·

---

## ğŸš€ å¿«é€Ÿå®‰è£…ï¼ˆè‡ªåŠ¨åŒ–ï¼‰

### æ–¹æ³•1ï¼šä½¿ç”¨å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰

#### Linux/macOS

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/Kimi-ming/Large-Model-Tutorial.git
cd Large-Model-Tutorial

# 2. è¿è¡Œå®‰è£…è„šæœ¬
chmod +x scripts/setup.sh
./scripts/setup.sh

# 3. ç­‰å¾…å®‰è£…å®Œæˆï¼ˆçº¦5-10åˆ†é’Ÿï¼‰
```

#### Windows (Git Bash)

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/Kimi-ming/Large-Model-Tutorial.git
cd Large-Model-Tutorial

# 2. è¿è¡Œå®‰è£…è„šæœ¬
bash scripts/setup.sh
```

å®‰è£…è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… æ£€æŸ¥Pythonç‰ˆæœ¬
- âœ… æ£€æµ‹GPUç¯å¢ƒï¼ˆCUDA/ROCmï¼‰
- âœ… å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…
- âœ… éªŒè¯ç¯å¢ƒé…ç½®

### æ–¹æ³•2ï¼šä½¿ç”¨Condaç¯å¢ƒï¼ˆæ¨èåˆå­¦è€…ï¼‰

```bash
# 1. åˆ›å»ºæ–°ç¯å¢ƒ
conda create -n vlm-tutorial python=3.11 -y
conda activate vlm-tutorial

# 2. å…‹éš†ä»“åº“
git clone https://github.com/Kimi-ming/Large-Model-Tutorial.git
cd Large-Model-Tutorial

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. éªŒè¯å®‰è£…
python -c "import torch; print('PyTorch:', torch.__version__); print('CUDAå¯ç”¨:', torch.cuda.is_available())"
```

---

## ğŸ”§ æ‰‹åŠ¨å®‰è£…ï¼ˆåˆ†æ­¥éª¤ï¼‰

### æ­¥éª¤1ï¼šå®‰è£…Python

#### Ubuntu/Debian

```bash
sudo apt update
sudo apt install python3.11 python3.11-venv python3-pip
```

#### macOS (ä½¿ç”¨Homebrew)

```bash
brew install python@3.11
```

#### éªŒè¯å®‰è£…

```bash
python3 --version  # åº”æ˜¾ç¤º Python 3.8+
pip3 --version
```

### æ­¥éª¤2ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

#### ä½¿ç”¨venv

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»ç¯å¢ƒ
source venv/bin/activate  # Linux/macOS
# æˆ–
.\venv\Scripts\activate   # Windows
```

#### ä½¿ç”¨Condaï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºç¯å¢ƒ
conda create -n vlm-tutorial python=3.11
conda activate vlm-tutorial
```

### æ­¥éª¤3ï¼šå…‹éš†é¡¹ç›®

```bash
git clone https://github.com/Kimi-ming/Large-Model-Tutorial.git
cd Large-Model-Tutorial
```

### æ­¥éª¤4ï¼šå®‰è£…ä¾èµ–

#### æ ¸å¿ƒä¾èµ–ï¼ˆå¿…éœ€ï¼‰

```bash
pip install -U pip setuptools wheel
pip install -r requirements.txt
```

#### å¼€å‘ä¾èµ–ï¼ˆå¯é€‰ï¼‰

```bash
pip install -r requirements-dev.txt
```

#### å›½å†…é•œåƒåŠ é€Ÿ

å¦‚æœä¸‹è½½é€Ÿåº¦æ…¢ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒæºï¼š

```bash
# ä¸´æ—¶ä½¿ç”¨æ¸…åæº
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# æˆ–æ°¸ä¹…é…ç½®
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
```

### æ­¥éª¤5ï¼šå®‰è£…GPUæ”¯æŒï¼ˆå¯é€‰ï¼‰

#### NVIDIA GPU (CUDA)

```bash
# æ£€æŸ¥CUDAç‰ˆæœ¬
nvidia-smi

# PyTorchä¼šè‡ªåŠ¨å®‰è£…CUDAæ”¯æŒçš„ç‰ˆæœ¬
# å¦‚éœ€æŒ‡å®šCUDAç‰ˆæœ¬ï¼Œè®¿é—®ï¼šhttps://pytorch.org/
```

#### AMD GPU (ROCm)

```bash
# å®‰è£…ROCmç‰ˆPyTorch
pip install torch torchvision --index-url https://download.pytorch.org/whl/rocm5.7
```

#### Apple Silicon (Mç³»åˆ—èŠ¯ç‰‡)

```bash
# PyTorchè‡ªåŠ¨æ”¯æŒMPSåŠ é€Ÿï¼Œæ— éœ€é¢å¤–å®‰è£…
```

---

## âœ… éªŒè¯å®‰è£…

### è¿è¡ŒéªŒè¯è„šæœ¬

åˆ›å»ºæµ‹è¯•æ–‡ä»¶ `test_env.py`ï¼š

```python
import sys
import torch
import torchvision
import transformers
from PIL import Image

print("=" * 50)
print("ç¯å¢ƒéªŒè¯")
print("=" * 50)

print(f"\nPythonç‰ˆæœ¬: {sys.version}")
print(f"PyTorchç‰ˆæœ¬: {torch.__version__}")
print(f"Torchvisionç‰ˆæœ¬: {torchvision.__version__}")
print(f"Transformersç‰ˆæœ¬: {transformers.__version__}")

print(f"\nGPUæ”¯æŒ:")
print(f"  CUDAå¯ç”¨: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"  CUDAç‰ˆæœ¬: {torch.version.cuda}")
    print(f"  GPUæ•°é‡: {torch.cuda.device_count()}")
    print(f"  GPUåç§°: {torch.cuda.get_device_name(0)}")

# æ£€æŸ¥MPSï¼ˆApple Siliconï¼‰
if hasattr(torch.backends, 'mps'):
    print(f"  MPSå¯ç”¨: {torch.backends.mps.is_available()}")

print(f"\næµ‹è¯•ç®€å•è¿ç®—:")
x = torch.randn(2, 3)
y = x * 2
print(f"  âœ“ Tensorè¿ç®—æ­£å¸¸")

print("\n=" * 50)
print("âœ… ç¯å¢ƒéªŒè¯é€šè¿‡ï¼")
print("=" * 50)
```

è¿è¡ŒéªŒè¯ï¼š

```bash
python test_env.py
```

é¢„æœŸè¾“å‡ºï¼š

```
==================================================
ç¯å¢ƒéªŒè¯
==================================================

Pythonç‰ˆæœ¬: 3.11.x
PyTorchç‰ˆæœ¬: 2.x.x
Torchvisionç‰ˆæœ¬: 0.x.x
Transformersç‰ˆæœ¬: 4.x.x

GPUæ”¯æŒ:
  CUDAå¯ç”¨: True
  CUDAç‰ˆæœ¬: 12.1
  GPUæ•°é‡: 1
  GPUåç§°: NVIDIA GeForce RTX 4090

æµ‹è¯•ç®€å•è¿ç®—:
  âœ“ Tensorè¿ç®—æ­£å¸¸

==================================================
âœ… ç¯å¢ƒéªŒè¯é€šè¿‡ï¼
==================================================
```

---

## ğŸ” å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼špipå®‰è£…é€Ÿåº¦æ…¢

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨å›½å†…é•œåƒæº

```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### é—®é¢˜2ï¼šCUDAç‰ˆæœ¬ä¸åŒ¹é…

**ç°è±¡**ï¼š`RuntimeError: CUDA out of memory` æˆ–æ— æ³•ä½¿ç”¨GPU

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. æ£€æŸ¥CUDAç‰ˆæœ¬ï¼š
   ```bash
   nvidia-smi
   nvcc --version
   ```

2. å®‰è£…åŒ¹é…çš„PyTorchï¼š
   ```bash
   # è®¿é—® https://pytorch.org/ é€‰æ‹©å¯¹åº”ç‰ˆæœ¬
   pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
   ```

### é—®é¢˜3ï¼šimport torchå¤±è´¥

**ç°è±¡**ï¼š`ImportError: cannot import name 'code'`

**åŸå› **ï¼šé¡¹ç›®ç›®å½•åä¸Pythonæ ‡å‡†åº“å†²çª

**è§£å†³æ–¹æ¡ˆ**ï¼šä¸è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ç›´æ¥è¿è¡ŒPythonï¼Œæˆ–ï¼š

```bash
cd ~  # åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•
python -c "import torch; print(torch.__version__)"
```

### é—®é¢˜4ï¼šWindowsä¸‹Git Bashè¿è¡Œè„šæœ¬å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨bashæ˜ç¡®è°ƒç”¨
bash scripts/setup.sh

# æ–¹æ³•2ï¼šè½¬æ¢è¡Œå°¾ç¬¦
dos2unix scripts/setup.sh  # éœ€å…ˆå®‰è£…dos2unix
```

### é—®é¢˜5ï¼šæƒé™ä¸è¶³

**ç°è±¡**ï¼š`Permission denied`

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# Linux/macOS
chmod +x scripts/setup.sh
chmod +x scripts/download_models.sh

# æˆ–ä½¿ç”¨bash/shè¿è¡Œ
bash scripts/setup.sh
```

---

## ğŸ“¦ ä¾èµ–åŒ…è¯´æ˜

### æ ¸å¿ƒä¾èµ–

| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| torch | >=2.0.0 | æ·±åº¦å­¦ä¹ æ¡†æ¶ |
| torchvision | >=0.15.0 | å›¾åƒå¤„ç† |
| transformers | >=4.35.0 | é¢„è®­ç»ƒæ¨¡å‹åŠ è½½ |
| huggingface-hub | latest | æ¨¡å‹ä¸‹è½½ |
| pillow | latest | å›¾åƒè¯»å†™ |

### å¯é€‰ä¾èµ–

| åŒ…å | ç”¨é€” | å®‰è£…å‘½ä»¤ |
|------|------|----------|
| bitsandbytes | æ¨¡å‹é‡åŒ–ï¼ˆèŠ‚çœæ˜¾å­˜ï¼‰| `pip install bitsandbytes` |
| peft | å‚æ•°é«˜æ•ˆå¾®è°ƒ | `pip install peft` |
| accelerate | åˆ†å¸ƒå¼è®­ç»ƒ | `pip install accelerate` |
| jupyter | äº¤äº’å¼å¼€å‘ | `pip install jupyter` |

---

## ğŸ¯ ä¸‹ä¸€æ­¥

ç¯å¢ƒå®‰è£…å®Œæˆåï¼Œè¯·ç»§ç»­é˜…è¯»ï¼š

1. **[å¿«é€Ÿå¼€å§‹](./02-å¿«é€Ÿå¼€å§‹.md)** - è¿è¡Œç¬¬ä¸€ä¸ªæ¨ç†ç¤ºä¾‹
2. **[æ¨¡å‹ä¸‹è½½æŒ‡å—](./03-æ¨¡å‹ä¸‹è½½æŒ‡å—.md)** - ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹
3. **[å¸¸è§é—®é¢˜è§£ç­”](../../FAQ.md)** - æ›´å¤šç–‘éš¾è§£ç­”

---

## ğŸ’¬ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹ [FAQæ–‡æ¡£](../../FAQ.md)
2. åœ¨GitHubæIssueï¼šhttps://github.com/Kimi-ming/Large-Model-Tutorial/issues
3. æŸ¥çœ‹ç›¸å…³æ–‡æ¡£çš„"æ•…éšœæ’é™¤"éƒ¨åˆ†

---

**ä¸Šæ¬¡æ›´æ–°**ï¼š2025-11-01  
**é€‚ç”¨ç‰ˆæœ¬**ï¼šv0.5-MVP

